
local _, S = ...
S.gnt(1350,"990,1015,1012,987,994,1011,1012,989,1011,1007,1005,997,995,1011,999,1007,1011,1003,1001,1006^1010,1007,1004,1004,999,993,1005,994,1004,997,942,938,933,996,939,942,938,1004,1007,1011,997,933,996,939,942,938,1015,1001,1006,942,938,933,996,939^995,993,1011,1001,1006,1007,942,938,933,996,939,942,938,996,1007,1013,994,1004,997,942,938,933,996,939,942,938,1012,1010,1001,1008,1008,959,1004,997^995,993,1011,1001,1006,1007,942,938,1004,997,999,1001,1012,942,938,1011,993,998,997,942,938,995,993,1011,1001,1006,1007^990,1011,997,1004,1004,1001,1006,999,999,1007,1004,996,1011,959,998,1007,1010,995,1011,999,1007^990,1015,1012,994,1010,1011,999,1008,932^990,1015,1012,994,933,996,939,1005,944,951,999,1008^990,1015,1012,987,994,1011,1012,989,995,1011,933,942,959,999,1007,1011,1003,1001,1006^990,1015,1012,987,994,1011,989,1008,1010,997,1008,993,1001,996,995,993,1010,996^990,1015,1012,987,994,1011,989,1010,1011,993,995,995,1007,1013,1006,1012^1010,1007,1004,1004,942,938,933,996,939,942,938,1010,1007,1004,1004,942,938,933,996,939,942,938,994,997,1012^1004,1013,995,1003,942,938,1010,1007,1004,1004,942,938,996,1007,1013,994,1004,997,942,938,999,1007,1004,996^990,1011,997,1004,1004,1001,1006,999,995,1011,999,1007,995,993,1011,997^990,1015,1012,987,994,1011,1012,989,1003,997,1017,1011,1001,1006,995,1011,999,1007^990,1015,1012,987,994,1011,1012,989,1010,1011,944,951,999,1007,1004,996^933,996,939,942,938,996,987,1007,1013,989,987,1013,994,989,994,1004,997,942,938,933,996,939,942,938,1012,1010,1001,1008^990,994,1013,1017,1001,1006,999,1007,1011,1010,1011,999,1007,1004,996,1015,1001,1012,1000,1015,1007,1015,999,1007,1004,996^990,999,1007,1012,993,1006,1017,1010,1013,1006,997,1011,995,993,1008,997,999,1007,1004,996,943,1015,1005,997^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,1003,997,1017^1010,1007,1004,1004,942,938,999,993,1005,997,942,938,999,1007,1004,996,942,938,1015,1001,1006,942,938,1004,1007,1015,997,1010^1015,1012,987,994,1011,989,1015,1007,1015,999,1007,1004,996,942,938,1010,1011,999,1007,1004,996^995,993,1011,1001,1006,1007,942,938,1015,1000,1001,1011,1008,997,1010,942,938,1001,1006,998,1007^999,1007,1004,996,998,1007,1010,1010,1013,1006,997,1011,995,993,1008,997,999,1007,1004,996^990,1015,1012,987,1011,1012,989,993,995,995,1007,1013,1006,1012,1015,1001,1012,1000^1015,993,1006,1012,1012,1007,994,1013,1017,987,943,988,989,1011,997,1004,1004,995,1011,999,1007,1001,1012,997,1005^990,999,1007,1012,1011,1007,1005,997,1010,1011,944,951,943,959,1010,959,1011,959,947,959,999,1007,1004,996,1004,993,1017,1001,1006,999,993,1010,1007,1013,1006,996,942,938,1005,997^990,1011,997,1004,1004,1001,1006,999,1011,1007,1005,997,995,1011,999,1007,995,993,1011,997^990,1015,1012,987,994,1011,989,999,1007,1011,1003,1001,1006,1011^1010,1007,1013,1004,997,1012,1012,997,942,938,1010,1007,1004,1004,942,938,946,1016,942,938,947,1016^1004,1013,995,1003,942,938,1010,1007,1004,1004,942,938,933,996,939,1003,942,938,1005,1001,1006,1013,1012,997,1011,942,938,1008,1011,1012^990,1015,1012,987,994,1011,1012,989,999,1007,1004,996,998,1007,1010,995,1011,999,1007^990,1015,1012,987,994,1011,1012,989,995,1011,1011,1003,1001,1006,1011^990,1015,1012,994,999,1007,1004,996,942,938,999,993,1005,997,1012,1001,1005,997^990,1015,1012,987,994,1011,989,1008,1010,997,1008,993,1001,996,999,993,1005,997,995,993,1010,996^1015,1012,987,994,1011,989,1010,1013,1006,997,1011,995,993,1008,997,999,1007,1004,996^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,995,996,1003,997,997,959,1017^1015,1012,987,994,1011,989,1015,1007,1015,999,1007,1004,996,942,938,1010,1011,995,1007,1001,1006,1012,959,1011^990,1015,1012,987,1011,1012,989,1015,1007,1015,993,995,995,1007,1013,1006,1012^990,999,1007,1012,993,1006,1017,1010,1011,944,959,947,943,1010,1011,944,959,951,999,1007,1004,996,1004,993,1017,1001,1006,999,993,1010,1007,1013,1006,996,942,938,999,1007,1007,996,1007,998,998,997,1010^996,1007,1013,994,1004,997,942,938,1012,1010,1001,1008,1008,959,1004,997,942,938,995,993,1011,1001,1006,1007^990,1015,1012,1011,995,1000,997,993,1008,999,1007,1004,996^996,987,1007,1013,989,987,1013,994,989,994,1004,997,942,938,933,996,939,942,938,1012,1010,1001,1008,1008,959,1004,997^990,1015,1012,987,994,1011,1012,989,1004,997,999,1001,1007,1006,995,959,996,959,1003,997,1017^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,995,1000,997,993,1008^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,995,993,1011,997^990,1015,1012,1012,1015,1007,1015,999,998,1007,1010,1007,1011,1010,1011,999^995,993,1011,1001,1006,1007,942,938,1010,1007,1004,1004,942,938,933,996,939,942,938,1010,1007,1004,1004,942,938,933,996,939^990,1015,1012,1012,1015,1007,1015,999,998,1007,1010,1010,1011,944,951,999^1015,1012,987,994,1011,989,942,938,1010,1013,1006,997,1011,995,993,1008,997,1005,1007,1006,997,1017,942,938,933,996,939,1003^990,994,1013,1017,1001,1006,999,995,1011,999,1007,1003,1006,1001,987,998,1014,989,997^990,1015,1012,1012,1015,1007,1015,999,1007,1004,996,998,1007,1010,1007,1004,996,1011,995,1000,1007,1007,1004,1010,1011,999,1007,1004,996^997,1016,995,1000,993,1006,999,1001,1006,999,1010,1011,999,1007,1004,996^990,1015,1012,987,994,1011,989,999,993,1005,997,995,993,1010,996^995,993,1011,1001,1006,1007,942,938,994,997,1012,942,938,933,996,939^995,993,1011,1001,1006,1007,942,938,933,996,939,1016,946,942,938,933,996,939,1016,947^995,993,1011,1001,1006,1007,942,938,1010,1007,1004,1004,942,938,996,1007,1013,994,1004,997^995,993,1011,1001,1006,1007,942,938,996,1001,995,997,942,938,933,996,939,942,938,1012,1010,1001,1008,1004,997^1015,1012,987,994,1011,989,1010,1013,1006,997,1011,995,993,1008,997,1008,1013,1010,997^990,1015,1012,987,994,1011,989,994,993,1004,993,1006,995,997,1008,993,1017,1008,993,1004,994,1017,999,1007,1004,996^999,993,1005,994,1004,997,942,938,1010,1007,1004,1004,942,938,1016,946,942,938,1010,1007,1004,1004,942,938,1016,949^990,1011,997,1004,1004,1001,1006,999,995,1011,999,1007,1011,1003,1001,1006^990,1012,1010,993,996,1001,1006,999,995,1011,999,1007,942,938,999,1007,1004,996^995,1011,999,1007,1011,1003,1001,1006,1011,942,938,999,1007,1004,996,942,938,1011,1000,1007,1008,942,938,1005,1007,1013,1006,1012,1011^1015,1012,987,994,1011,1012,989,1010,1011,947,959,999,1007,1004,996,942,938,1015,1007,1015,999,1007,1004,996^990,994,1013,1017,1001,1006,999,995,1000,997,993,1008,995,1011,999,1007,1011,1003,1001,1006^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,1003,1006,1001,987,998,1014,989,997^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,995,993,1005,1007^990,1015,1012,987,994,1011,1012,989,1005,1017,999,1007,1004,996,998,1007,1010,995,1011,999,1007,1011,1003,1001,1006^990,1015,1012,987,994,1011,989,933,996,939,1005,1007,1006,1012,1000,942,938,999,993,1005,997,1012,1001,1005,997^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,993,995,995^996,1001,995,997,942,938,1016,946,942,938,1016,947,942,938,994,997,1012,1011^990,994,1013,1017,1001,1006,999,995,1011,933,942,959,999,987,944,1007,989,1011,1003,1001,1006^990,1012,1010,993,996,1001,1006,999,1015,1007,1015,999,1007,1004,996,998,1007,1010,1007,959,1011,959,1010,1011,999,1007,1004,996^990,1015,1012,1011,995,1000,997,993,1008,993,1006,996,998,993,1011,1012,999,1007,1004,996^994,997,1012,942,938,1010,1007,1004,1004,942,938,1016,946,942,938,1016,947,942,938,1005,1001,1006,942,938,1005,993,1016^1015,1007,1015,999,1007,1004,996,998,1007,1010,995,1011,999,1007,1003,997,1017^999,1007,1004,996,942,938,1012,1010,1001,1008,1008,959,1004,997,942,938,995,993,1011,1001,1006,1007^990,1015,1012,994,999,1007,1004,996,942,938,1005,1007,1013,1006,1012^990,1015,1012,1011,933,996,939,996,993,1017,1011,959,999,993,1005,997,995,993,1010,996^1015,993,1006,1012,1012,1007,1011,997,1004,1004,987,943,988,989,994,1013,1017,995,1011,999,1007,1001,1012,997,1005^990,1015,1012,1012,1015,1007,1015,999,1007,1004,996,998,1007,1010,1007,1011,1010,1011^990,1015,1012,987,994,1011,989,999,993,1005,997,1012,1001,1005,997^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,1001,1012,997,1005^1015,1012,1011,1015,1007,1015,993,995,995,1007,1013,1006,1012,942,938,997,1008,1001,995^990,1015,1012,987,994,1011,989,933,996,939,1010,1011,993,995,995,1007,1013,1006,1012^990,1015,1012,987,994,1011,989,999,993,1005,997,995,1007,996,997^1012,1010,993,996,1001,1006,999,1005,1017,1015,1007,1010,1004,996,1007,998,1015,993,1010,995,1010,993,998,1012,999,1007,1004,996,998,1007,1010,942,938,1010,1013,1006,997,1011,995,993,1008,997,999,1007,1004,996^990,1015,1012,1011,933,996,939,996,993,1017,1011,959,999,993,1005,997,1012,1001,1005,997^990,1015,1012,987,1011,994,1012,989,1015,1007,1015,999,1007,1004,996,998,1007,1010,995,1011,999,1007,1011,1003,1001,1006^990,1015,1012,1011,933,996,939,1003,998,1007,1010,933,996,939,997,1013^990,994,1013,1017,1001,1006,999,995,1011,999,1007,1003,997,1017^990,1015,1012,987,994,1011,1012,989,995,1011,999,1007,1011,1012,997,993,1005,999,1001,998,1012^990,1015,1012,987,994,1011,989,933,996,939,996,993,1017,942,938,999,993,1005,997,995,993,1010,996^1010,1013,1006,997,1011,995,993,1008,997,999,1007,1004,996,998,1007,1010,1015,1007,1015,999,1007,1004,996^990,994,1013,1017,1001,1006,999,1010,1011,947,1011,1012,1013,998,998^1015,1012,987,994,1011,989,1010,1013,1006,997,1011,995,993,1008,997,993,995,995,1007,1013,1006,1012^990,1015,1012,987,994,1011,1012,989,993,1006,1017,995,1011,999,1007,1011,1003,1001,1006^995,993,1011,1001,1006,1007,942,938,943,1015,942,938,933,996,939,942,938,1010,1007,1004,1004^990,1015,1012,987,994,1011,1012,989,995,1000,997,993,1008,995,1011,999,1007,1011,1003,1001,1006^990,1015,1012,987,994,1011,989,993,959,1006,959,993,1015,997,1011,1007,1005,997,1010,1011,993,995,995,1007,1013,1006,1012^994,1013,1017,1001,1006,999,959,1010,1013,1006,997,1011,995,993,1008,997,987,993,999,989^990,1015,1012,994,1007,1011,1010,1011,999,1008^990,1015,1012,987,994,1011,1012,989,1005,1017,1015,1007,1015,999,1007,1004,996,942,938,995,1011,999,1007,1011,1003,1001,1006^1010,1007,1004,1004,942,938,1015,1001,1006,942,938,996,1007,1013,994,1004,997,942,938,1005,1001,1006,942,938,1005,993,1016^990,1015,1012,987,994,1011,989,987,947,950,989,944,996,993,1017,1011,959,1008,1010,997,1008,993,1001,996,999,993,1005,997,1012,1001,1005,997^990,1011,997,1004,1004,1001,1006,999,995,1011,999,1007,1001,1012,997,1005","946,945,946,950,1126,1074,1027,1126,1061,1064,1128,1074,1076,950,1126,1053,1083,1129,1088,1055,1126,1033,1080,949,1128,1045,1075,1126,1081,1071,1127,1042,1081,1128,1050,1086,1129,1040,1053,1125,1084,1080,1127,1054,1062,1126,1038,1046,1126,1073,1074,1127,1034,1044,1125,1084,1032,1127,1046,1037,1125,1082,1036,1129,1058,1025,946,948,1128,1034,1082,1125,1084,1080,1006,1126,1054,1041,1130,1067,1042,1127,1073,1077,1126,1030,1028,1128,1077,1057,1127,1053,1034,1125,1086,1038,1128,1086,1071,1130,1032,1042,1126,1081,1026,951,945,945,1128,1039,1073,1129,1077,1064^1013,1002,1013,994,1007,1002,1014,1006,995,994,1018,943,939,1000,1008,1005,997^1016,998,995,1012,1002,1013,998,943,939,998,995,994,1018,1000,1008,1005,997,1012,934,943,996,1008,1006^991,1012,1013,1018,1005,998,1126,1030,1069,1125,1085,1051,1127,1036,1052,1126,1041,1029,1129,1026,1037,1125,1081,1051,1128,1039,1066,1126,1071,1079,999,994,1011,1006,1126,1040,1063,1126,1061,1047,1126,1030,1069,1125,1085,1051,999,994,1011,1006,1001,1128,1039,1036,1126,1083,1064,1126,1037,1030,1126,1052,1059,1127,1053,1034,1127,1076,1046,1126,1081,1033,997,1004,1130,1067,1042,1128,1034,1064,1127,1053,1072,1126,1054,1042,1006,1128,1039,1036,1126,1083,1064,946,954,1127,1053,1038,1126,1035,1058,1126,1050,1065,952,1128,1027,1082,1126,1085,1025,1127,1034,1044,933^1009,1015,1009,943,939,1002,1008,1016,943,939,1008,1004,949,1000,1008,1005,997^1010,1010,947,950,946,946,948,945,949,954,948^991,1129,1025,1026,1128,1034,1037,1128,1087,1039,1127,1053,1038,996,1008,1000^1012,1004,1018,1009,998,943,939,996,1001,1002,998,999,995,1008,1008,1012,1013^1012,1004,1018,1009,998,943,939,996,994,1005,1015,1002,1007,934,943,999,1011,998,998,1019,998^1013,1002,1013,994,1007,1002,1014,1006,995,994,1018,943,939,1006,1002,1007,1014,1013,988,998,1008,990^997,998,1013,994,1002,1005,1012,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,945,1008,990,1006^1013,1002,1013,994,1007,1002,1014,1006,995,994,1018,943,939,1000,1011,994,1013,1002,1012^1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006,943,939,996,1008,1007,1013,994,996,1013^996,1008,1007,1013,994,996,1013,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006^1010,1010,943,939,946,945,945,953,949,950,954,954,950^1012,1001,994,997,1008,1016,995,1008,1008,1012,1013,934,943,996,1008,1006,943,939,1000,1014,1002,1005,997^1012,1004,1018,1009,998,943,939,1000,998,1011,994,1005,997,995,994,1010^1015,1125,1088,1058,943,939,946,950,945,950,948,953,946,954,945,952^997,1002,1012,996,1008,1011,997,1006,998,1005,1008,1011,1002,1017,1017,949,946,950,946^1016,998,995,1009,994,1000,998,943,939,998,1009,1002,996,996,994,1011,1011,1018^1128,1084,1028,1128,1083,1064,943,939,995,998,994,1011,1016,1008,1016,988,941,943,990,996,1008,1006^996,1001,998,996,1004,943,939,1016,1008,1016,1001,1014,1007,1013,934,943,996,1008,1006^1016,1013,1012,1006,1018,1013,1001,1002,996,946,934,997,1012,1013,994,1011,1013,1002,1007,1000,1007,1008,1016,943,939,1012,1006,1008,1008,1013,1001,1011,1014,1007,1012,943,939,998,1017,1009,998,1011,1002,998,1007,996,998,943,939,998,1005,1002,1013,998,1009,1005,994,1018,998,1011,1012,943,939,995,998,1012,1013,1009,1011,1002,996,998,1012,943,939,994,1005,1012,1008,1012,998,1005,1005,1002,1007,1000,943,939,1000,1008,1005,997,1008,1007,1005,1018^1012,1001,1002,1007,998,995,1008,1008,1012,1013,953,948,948,945^1012,1004,1018,1009,998,943,939,1000,998,1007,1018,934,943,1004,947^995,1008,1008,1012,1013,1002,1007,1000,988,934,943,941,990,1009,1011,1008,943,939,1005,1008,1008,1013^1016,1013,1012,943,939,998,934,943,939,1009,934,943,939,1002,934,943,939,996,934,943,939,996,934,943,939,994,934,943,939,1011,934,943,939,1011,934,943,939,1018,934,943,939,996,934,943,939,1008,934,943,939,1006^1125,1088,1058,1000,1008,1005,997,1016,1008,1016^1011,1008,1105,1084,1105,1077,994,988,934,943,941,990,1009,1106,1029,943,939,1015,1002,1012,994^991,1006,994,1011,1002,1007,994,1130,1049,1088,1127,1052,1085,1129,1036,1040,1128,1051,1029,1130,1059,1029,1129,1064,1026^999,995,1006,1013,998,994,1006,934,943,996,1008,1006,943,939,1000,994,1006,998^1125,1088,1058,997,994,1002,1016,1008,1016,953,953,953^995,998,1012,1014,996,1001,998,1007,943,939,1016,1008,1016,1015,998,1007,997,1008,1011,934,943,996,1008,1006^1125,1088,1058,950,949,954,954,951,950,953,948,953^1012,1004,1018,1009,998,943,939,994,1009,1009,1008,1005,994,1017,948,945,953,950^1012,1004,1018,1009,998,943,939,1001,998,1005,1006,1002,1011,952,950,952,953^1016,1013,1012,1006,1018,1013,1001,1002,996,943,939,1012,1013,994,1011,1013,1002,1007,1000,1007,1008,1016,943,939,1012,1006,1008,1008,1013,1001,1011,1014,1007,1012,997,1008,1007,998,995,1018,943,939,998,1005,1002,1013,998,1009,1005,994,1018,998,1011,1012,943,939,995,998,1012,1013,1009,1011,1002,996,998,1012,943,939,1016,998,994,1005,1012,1008,1012,1001,994,1011,998^997,1002,1012,996,1008,1011,997,1013,995,952,945,945,945^997,1002,1012,996,1008,1011,997,1004,1008,1004,1008,1019,1008,1011,1003,1004,998,952,950,945,952^991,996,1008,1000,1128,1087,1039,1127,1053,1038,1126,1080,1062,1125,1086,1053,1126,1071,1061^1016,1013,1012,943,939,1006,1018,1013,1001,1002,996,1004,998,1018,943,939,996,994,1011,1011,1018,1011,1014,1007,943,939,996,1008,1006,998,1000,998,1013,1018,1008,1014,1011,994,1005,1005,943,939,996,1001,998,994,1009,1009,1011,1002,996,998^1126,1087,1071,1125,1088,1058,943,939,947,947,949,952,951,953,947,950,946,947^1125,1088,1058,948,954,947,946,947,948,945,950,948^1016,1011,1002,1013,998,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006^991,1006,994,1011,1002,1007,994,1129,1072,1051,1127,1039,1062,1127,1048,1062^991,1006,994,1011,1002,1007,994,1126,1041,1029,1128,1064,1038,1128,1051,1071,1129,1027,1061^1009,1008,1016,998,1011,1005,998,960,1015,998,960,1005,1002,1007,1000,943,939,1011,994,1011,998,1006,1008,1014,1007,1013,1012,943,939,996,994,1011,1011,1018^1106,1031,998,1105,1086,988,994,998,990,943,939,1005,1008,1008,1013,1004,998,998,1009,998,1011,988,934,943,941,990,996,1008,1006^1007,1008,1014,1012,1012,1008,1006,1006,998,1012,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006^1016,1013,1012,943,939,994,1007,997,1008,1013,1001,998,1011,1009,1015,1009,1006,1008,1014,1007,1013,1012,994,1007,997,994,996,1001,1002,998,1015,943,939,1007,1008,1013,1008,1007,1005,1018,1016,1002,1005,1005,1018,1008,1014,1000,998,1013,943,939,994,1005,1008,1013,1008,999,934,997,1012,1016,1002,1007,1012,943,939,1012,998,1005,999,1009,1005,994,1018^1126,1087,1071,1125,1088,1058,943,939,948,950,950,948,948,953,954,952,946^1010,1010,943,939,947,953,950,946,952,948,946,953,953,952^991,994,995,1013,1129,1036,1074,1130,1052,1029,1126,1037,1030,1126,1052,1059,943,939,996,1008,1000,1126,1080,1062,1125,1086,1053,1126,1071,1061^997,1002,1012,996,1008,1011,997,995,994,1011,1012,994,1011,997,946,952,950,953^997,1002,1012,996,1008,1011,997,943,939,1006,994,1005,1009,1008,1008,1012,947,947,953,949^991,1006,994,1011,1002,1007,994,1127,1048,1064,1125,1081,1047,1128,1046,1037^1012,1002,1013,998,943,939,1006,1006,988,1008,945,990,1005,1015,1005,934,943,996,988,1008,945,990,1006^1012,1004,1018,1009,998,943,939,995,998,1005,1004,1008,1011,1004,961,1000,1006,994,1002,1005,934,943,996,1008,1006^1016,1013,1012,1015,1002,996,1002,1008,1014,1012,943,939,1008,1013,1001,998,1011,1009,1015,1009,1006,1008,1014,1007,1013,1012,943,939,996,994,1011,1011,1002,998,997,943,939,1012,1004,1002,1005,1005,943,939,1012,998,1005,999,1009,1005,994,1018^991,1006,994,1011,1002,1007,994,1128,1068,1055,1127,1035,1025,1126,1053,1083^1011,1006,995,943,939,1127,1033,1049,1128,1086,1042,1009,1011,998,1013,1013,1018,998,1005,998,1007,994^1016,1013,1012,1015,1002,996,1002,1008,1014,1012,943,939,1008,1013,1001,998,1011,1009,1015,1009,1006,1008,1014,1007,1013,1012,943,939,996,1008,1006,1009,1005,998,1013,1002,1008,1007,943,939,1001,1014,1007,997,1011,998,997,943,939,999,1002,1012,1001,1018^1125,1088,1058,943,939,946,952,952,953,953,954,950,950,948,949,946^991,996,1008,1000,1126,1030,1069,1125,1085,1051,1129,1041,1065,1126,1059,1044^1012,998,1005,1005,1002,1007,1000,943,939,999,1014,1005,1005,1006,994,1012,1013,998,1011,1005,1008,1008,1013,943,939,944,946,945,943,939,1009,998,1008,1009,1005,998,943,939,1006,994,1017,1000,998,994,1011,943,939,996,1001,998,994,1009,998,1012,1013,1009,1011,1002,996,998^1004,1001,994,1011,1002,997,994,1011,998,943,939,1013,994,1005,994,943,939,1001,994,1012,1013,994,1006,995,998,943,939,995,994,1005,994,1013,994,1011,1002,1007,943,939,949,1012,994,1005,1013,994,1003,1011,1008,995,998,943,939,1016,1006,998^1002,1007,999,1008,943,939,995,988,1008,945,990,988,1008,945,990,1006,995,988,1008,945,990,988,1008,945,990,1012,1013,941,996,988,1008,945,990,1006^1012,998,998,1006,1008,1011,998,943,939,1016,1008,1016,1001,1014,1007,1013,934,943,960,996,1008,1006^1125,1088,1058,946,953,946,952,950,946,948,951,951,945,947^1015,1002,1012,1002,1013,943,939,1006,1006,988,1008,945,990,1005,1015,1005,997,988,1008,945,990,1013,996,988,1008,945,990,1006^1013,1002,1013,994,1007,1002,1014,1006,995,994,1018,943,939,1005,1002,1015,1011,994,1002,1012,1008,1007^1126,1087,1071,1125,1088,1058,1005,1002,1014,1003,1002,994,1007,1017,1002,1008,1007,1000,953,953,947,953^1126,1087,1071,1125,1088,1058,1000,1001,998,1012,1013,1005,1014,1008,995,1008^1125,1088,1058,947,949,950,950,950,951,947,946,950^1015,1002,1012,1002,1013,943,939,997,1015,1002,1007,1000,997,1008,1013,1007,998,1013^1016,1008,1016,1001,1014,1007,1013,995,1008,1008,1012,1013,1002,1007,1000,1012,998,1011,1015,1002,996,998^1015,1002,1012,1002,1013,1009,998,1016,1009,998,1016,1012,1001,1008,1009^1011,1006,995,943,939,1126,1062,1062,1129,1088,1067,1126,1073,1045,1129,1060,1030,1126,1061,1032,1126,1038,1046,1126,1038,1047,943,939,1009,1015,1009,943,939,1002,1008,1016^997,1002,1012,996,1008,1011,997,1013,995,946,988,946,945,990,945,945^996,1008,1007,1013,994,996,1013,943,939,1013,1002,1013,994,1007,1002,1014,1006,995,994,1018^997,1002,1012,996,1008,1011,997,943,939,1009,994,949,954,949,953^1009,1011,1002,996,998,943,939,995,988,945,1008,990,988,945,1008,990,1006,995,988,945,1008,990,988,945,1008,990,1012,1013,988,934,943,941,990,996,988,945,1008,990,1006^1015,1002,1012,1002,1013,943,939,1016,1008,1016,1001,1014,1007,1013,934,943,1007,998,1013^1126,1087,1071,1125,1088,1058,946,950,950,952,949,953,949,948,951,945,953^991,1009,1000,1009,1126,1080,1062,1125,1086,1053,1126,1071,1061,1125,1086,1039,1125,1088,1054^1006,1018,1013,1001,1002,996,1000,1014,1002,1005,997,1002,1012,1012,998,1005,1002,1002,1007,1000,943,939,1011,1014,1007,1012,994,1007,997,1006,1018,1013,1001,1002,996,997,1014,1007,1000,998,1008,1007,1004,998,1018,1012,943,939,994,1001,998,994,997,1008,999,1013,1001,998,996,1014,1011,1015,998,1013,1008,997,994,1018,943,939,1007,1008,1011,998,1010,1014,1002,1011,998,1006,998,1007,1013,1012^991,1006,994,1011,1002,1007,994,1126,1053,1060,1126,1030,1034,1126,1031,1052^997,1002,1012,996,1008,1011,997,943,939,1011,998,1018,1015,1002,1007,1004,946,950,953,951^1126,1087,1071,1125,1088,1058,1019,1019,1016,1013,948,948,948^1125,1088,1058,1005,1008,1015,998,995,994,995,1018,947,948,949^995,994,1005,1008,995,1002,1007,997,961,1008,1014,1013,1005,1008,1008,1004,934,943,996,1008,1006^1010,1010,943,939,953,949,952,949,951,950,947,953,951^1015,1002,1012,1002,1013,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,945,1008,990,1006^1125,1088,1058,943,939,952,952,953,950,953,952,948,946,951^997,1002,1012,996,1008,1011,997,943,939,1012,1014,1007,1007,1018,949,946,950,946^1016,1013,1012,1006,997,1014,1007,1000,998,1008,1007,996,1001,998,1012,1013,1011,1014,1007,1012,943,939,1001,998,1005,1009,1018,1008,1014,1013,1008,999,994,1011,1006,994,1007,1018,994,1006,1008,1014,1007,1013,1008,999,1006,1018,1013,1001,1002,996,943,939,997,1011,1008,1009,994,1000,998,994,1011,1009,1002,998,996,998,943,939,1012,998,1013,994,1007,997,1011,998,994,997,1018,1013,1008,1000,1008^996,1001,998,996,1004,943,939,1016,1008,1016,1001,1014,1007,1013,934,943,1007,998,1013^991,1009,994,1002,997,1000,1014,1002,1005,997,1011,1014,1007,1012,943,939,1000,1005,1008,1011,1018,994,996,1001,1002,998,1015,998,1006,998,1007,1013,1012,943,939,1006,1008,1014,1007,1013,1012,943,939,1009,1008,1016,998,1011,1005,998,1015,998,1005,1002,1007,1000,943,939,1002,1007,999,1008^1125,1088,1058,1006,1012,1012,1003,999,1016^1013,1002,1013,994,1007,1002,1014,1006,995,994,1018,943,939,998,1017,1013,1011,994^1126,1045,1071,1126,1087,1071,943,939,953,954,949,950,953,945,947,948,946^1126,1081,1026,943,939,1126,1087,1071,1125,1088,1058,1012,1013,1018,1018,1005,998,998^1130,1032,1042,943,939,946,950,953,945,947,950,950,952,946,947,951^998,1009,1002,996,996,994,1011,1011,1018,934,943,1007,998,1013,943,939,1015,1002,1012,1002,1013^1105,1088,1009,1008,1105,1077,994,1105,1077,1105,1081,1006,1011,1009,1008,1105,1074,1105,1086,1105,1081,1106,1031,1018,943,939,1105,1088,1008,1105,1077,994,1009,1008,1004,943,939,1105,1075,1105,1088,1006^1125,1088,1058,1006,1002,994,946,946,946,947,950^1006,994,1000,998,1013,1008,1016,998,1011,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006^1000,1014,1002,1005,997,943,939,1012,1001,994,997,1008,1016,995,1008,1008,1012,1013,934,943,996,1008,1006^1015,1002,1012,1002,1013,943,939,1012,1002,1006,1009,1005,998,996,994,1011,1011,1018,934,943,996,1008,1006^1015,1002,1012,1002,1013,943,939,1009,998,1011,999,998,996,1013,1016,994,1018,934,943,1008,1007,998^1000,1008,1005,997,949,1008,1004,988,934,943,941,990,996,1008,1006,943,939,1012,1008,1013,996,1004^1010,1010,943,939,950,954,948,953,948,952,945,948,946^1012,1004,1018,1009,998,943,939,1006,994,1019,998,1016,1008,1016^1126,1087,1071,1127,1033,1042,946,950,950,952,949,953,949,948,951,945,953^1016,1013,1012,943,939,1005,1008,1008,1013,1011,994,1002,997,943,939,1000,1005,1008,1011,1018,943,939,1006,1008,1014,1007,1013,1012,943,939,1006,1008,1011,998,1002,1007,999,1008^1012,998,1005,1005,1002,1007,1000,943,939,998,1005,1002,1013,1002,1012,1013,1000,994,1006,1002,1007,1000,988,934,943,941,990,996,1008,1006^1009,1015,1009,943,939,1016,994,1005,1005,1000,994,1006,1002,1007,1000,988,934,943,941,990,996,1008,1006^1016,1013,1012,996,1001,998,994,1009,998,1012,1013,943,939,1006,1018,1013,1001,1002,996,997,1014,1007,1000,998,1008,1007,995,1008,1008,1012,1013,943,939,1000,998,1013,1018,1008,1014,1011,934,997,934,997,934,997,1002,1013,998,1006,1012,994,1013,1013,1001,998,998,1007,997,943,939,994,999,1004,943,939,1018,1008,1014,1016,1002,1005,1005,1000,998,1013,994,1005,1005,1013,1001,998,1013,1011,994,997,998,960,994,995,1005,998,1005,1008,1008,1013,943,939,1002,1007,999,1008^1012,1004,1018,1009,998,943,939,1009,1015,998,1012,1001,1008,1009^991,1016,1013,1012,1006,1018,1013,1001,1002,996,943,939,1016,998,998,1004,1005,1018,1005,1008,1008,1013,943,939,1001,998,1005,1009,1018,1008,1014,1013,1008,996,1005,998,994,1011,943,939,1005,998,1013,1014,1012,1001,994,1007,997,1005,998,1013,1001,998,995,1008,1011,1002,1007,1000,1009,994,1011,1013,1012^1008,999,999,998,1011,1012,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006^1125,1081,1084,1129,1029,1042,1126,1054,1041,1130,1067,1042,943,939,1126,1038,1026,1126,1074,1027,1125,1086,1039,1125,1088,1054,943,939,947,946,945,945,1009,1015,1009,1128,1070,1034,1128,1083,1064^1012,998,1005,1005,1002,1007,1000,943,939,1013,1002,1006,998,1011,943,939,1012,998,1005,999,1009,1005,994,1018,943,939,999,994,1012,1013,943,939,1013,1008,1009,1000,998,994,1011,943,939,1002,1007,999,1008^1015,1002,1012,1002,1013,1016,1008,1016,1015,998,1007,997,1008,1011,934,943,988,1007,996,1008,990,988,998,1008,1011,990,988,1013,1006,1000,990^997,1002,1012,996,1008,1011,997,1009,998,1016,1009,998,1016,950,949,949,953^997,1015,1002,1007,1000,943,939,1009,1008,1016,998,1011,1005,998,960,1015,998,960,1005,943,939,997,1015,1002,1007,1000^1012,1004,1018,1009,998,943,939,1003,994,1012,1006,1002,1007,998,995,994,995,1018,945,949,945,953^991,995,1008,1008,1012,1013,1002,1007,1000,1006,1018,1013,1001,1002,996,943,939,997,1014,1007,1000,998,1008,1007,1012,994,1007,997,1011,994,1002,997,1012,943,939,1011,994,1011,998,1006,1008,1014,1007,1013,1012,943,939,1009,1015,1009,1001,998,1005,1009^991,1006,994,1011,1002,1007,994,1009,1015,1009,1128,1075,1087,1130,1045,1041,1128,1051,1071,1129,1027,1061^1125,1088,1058,995,994,995,998,1018,946,946,947,948^1015,1002,1012,1002,1013,943,939,997,1015,1002,1007,1000,934,943,1007,998,1013^1126,1087,1071,1125,1088,1058,943,939,1000,1008,1005,997,999,1008,1011,1012^1010,941,960,1010,946,945,948,953,950,954^1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006,943,939,1002,1007,999,1008^1000,1008,1005,997,943,939,1000,988,1008,945,990,1005,997,996,998,988,1008,945,990,988,934,943,941,990,996,988,1008,945,990,1006^999,1014,1005,1005,1011,1014,1007,943,939,1000,1014,994,1011,994,1007,1013,998,998,1003,1014,1012,1013,999,1008,1011,934,997,934,997,940,998,1014,1011,943,939,1013,1008,1007,1002,1000,1001,1013^1016,1008,1016,996,1005,994,1012,1012,1002,996,988,934,943,941,990,1000,1009,1005,994,1018,988,934,943,941,990,1009,1011,1008^997,1015,1002,1007,1000,943,939,1018,996,1105,1084,1018,1011,1105,1081,943,939,997,1015,1002,1007,1000^1126,1087,1071,1125,1088,1058,943,939,946,950,945,950,948,953,946,954,945,952^1126,1087,1071,1125,1088,1058,943,939,946,953,951,954,947,947,945,953,952,949,950^999,994,996,998,995,1008,1008,1004,934,943,996,1008,1006,944,1012,1009,1011,1019,998,997,994,1003,1004,1008,1007,1013,1008,1009,1005^1013,998,1005,998,1000,1011,994,1006,943,939,994,1006,1002,1011,994,1007,1000,994,1006,1002,1007,1000^996,1005,994,1012,1012,943,939,999,995,1006,1013,998,994,1006,934,943,996,1008,1006^1105,1088,1008,1006,1008,1105,1079,998,1006,943,939,1007,1002,1000,1001,1013,1006,1008,1007,998,1018,988,934,943,941,990,1011,1014^1010,1010,943,939,946,949,948,948,950,948,950,951,947,953^1001,998,1011,998,1006,1006,988,945,1008,990,1005,1015,1005,988,934,943,941,990,960,996,988,945,1008,990,1006^1125,1088,1058,1008,1004,949,1000,1008,1005,997^1012,1002,1013,998,1001,998,1005,1009,1016,1008,1016,934,943,1006,998^1126,1037,1030,1126,1052,1059,943,939,950,947,952,948,948,953,954,948,949^998,1009,996,994,1011,1011,1002,998,1012,943,939,1012,1004,1018,1009,998^1015,1002,1012,1002,1013,943,939,1016,1008,1016,1001,1014,1007,1013,934,943,996,1008,1006^1015,1017,1003,1002,1007,1000,1017,1014,994,1007,948,948,949,949,950,947,946^1010,1010,943,939,948,946,954,949,950,947,946,953,949,953^1010,952,947,949,947,947,948,949,949,953^1008,1014,1011,1013,998,994,1006,943,939,1001,998,1005,1009,1018,1008,1014,943,939,1000,998,1013,1018,1008,1014,1011,943,939,1013,1008,997,994,1018,943,939,1000,998,1013,1012,1013,994,1011,1013,998,997^1002,1000,999,994,1007,1012,943,939,1012,1013,1008,996,1004,943,939,997,998,1005,1002,1015,998,1011^1010,1010,947,952,954,946,947,949,951,948,946^1010,1010,948,946,953,947,950,953,948,950,945,954,943,939,1012,1004,1018,1009,998^1016,1013,1012,943,939,1013,996,1000,1006,1008,1014,1007,1013,1012,943,939,1000,988,1008,945,990,1005,997,943,939,1012,994,1005,998^1129,1035,1072,1003,1002,1007,1000,1017,1014,994,1007,948,948,949,949,950,947,946^994,1013,1013,998,1007,1013,1002,1008,1007,943,939,998,1009,1002,960,996,996,994,1011,1011,1018,934,943,996,1008,1006^1002,1007,999,1008,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,960,996,988,945,1008,990,1006^1013,1002,1013,994,1007,1002,1014,1006,995,994,1018,943,939,1008,995,1013,998,1007,998,1019^1011,994,1013,1002,1007,1000,1012,943,939,996,1008,994,996,1001,1002,1007,1000,943,939,1005,998,1000,998,1007,997,994,1011,1018,943,939,1009,1011,1002,1019,998,1012,943,939,1000,1008,1005,997,943,939,1002,1007,999,1008^1125,1081,1067,1125,1083,1083,1126,1044,1026,1127,1081,1060,1126,1070,1041,943,939,1009,1011,1008,999,1008,1014,1007,997,1012,998,994^997,1002,1012,996,1008,1011,997,1014,1009,948,954,945,948^1016,1013,1012,1006,1018,1013,1001,1002,996,996,1001,998,1012,1013,999,994,1011,1006,943,939,1008,1014,1011,994,1012,1012,1002,1012,1013,994,1007,996,998,943,939,994,1007,1018,994,1006,1008,1014,1007,1013,943,939,1011,998,994,997,1018,1013,1008,1000,1008^1017,1002,1007,995,994,995,998,1018,946,946,947,948^994,1014,1013,1008,943,939,1012,1001,994,997,1008,1016,995,1008,1008,1012,1013,934,943,996,1008,1006^1125,1088,1058,1126,1040,1080,946,950,948,945,953,949,948,950,951,946,946^1010,1010,943,939,949,951,954,953,951,950,949,953,950^1016,1013,1012,943,939,1012,1004,1018,1009,998,943,939,995,1008,1008,1012,1013,1002,1007,1000,1001,998,1005,1009^991,1016,1013,1012,1013,996,1000,1006,1008,1014,1007,1013,943,939,996,1001,998,994,1009,1000,943,939,1012,1013,1008,996,1004,943,939,1012,994,1015,998^991,1001,998,1005,1009,1016,1002,1013,1001,1006,1018,1013,1001,1002,996,946,945,1004,998,1018,943,939,1012,998,1005,999,1009,1005,994,1018,944,1012,1001,994,1011,998,943,939,996,1001,998,1012,1013,1011,1014,1007,943,939,1009,1006,999,1008,1011,1002,1007,999,1008^1015,1002,1012,1002,1013,1000,1009,1005,994,1018,934,943,1009,1011,1008^1010,1010,943,939,947,947,952,953,945,949,953,946,952,954^1016,1008,1016,1006,994,1011,1013,988,934,943,941,990,1011,1014,943,939,1105,1080,1008,1105,1084,1008,1013,1008^1004,1008,995,1008,1005,997,943,939,1012,1009,1011,1019,998,997,994,1003,1004,1008,1007,1013,1008,988,934,943,941,990,1009,1005^1016,998,995,1012,1002,1013,998,943,939,998,1009,1002,996,996,994,1011,1011,1018^995,1008,1008,1012,1013,1013,1008,997,994,1018,943,939,1012,1001,994,997,1008,1016,995,1008,1008,1012,1013,934,943,996,1008,1006^1126,1087,1071,1125,1088,1058,943,939,947,951,951,947,952,954,954,946,948,949^1010,1010,946,954,952,946,952,945,953,946,948,952,943,939,1012,1004,1018,1009,998^1015,1002,1012,1002,1013,1016,1008,1016,1013,998,994,1006,934,943,1007,998,1013^1126,1087,1071,1125,1088,1058,943,939,950,954,948,953,948,952,945,948,946^1015,1002,1012,1002,1013,943,939,996,1008,1007,1010,1014,998,1012,1013,996,994,1009,1009,998,997,988,934,943,941,990,996,1008,1006^1126,1087,1071,1125,1088,1058,943,939,1012,998,1012,998,1000,1008,1005,997^1126,1087,1071,1125,1088,1058,998,1018,998,1012,1005,1008,1013^1016,998,996,1001,994,1013,943,939,1016,1013,1016,1013,1002,994,1007,948,947,946^1002,1007,999,1008,943,939,998,1009,1002,996,996,994,1011,1011,1018,988,934,943,941,990,996,1008,1006^996,1008,1007,1013,994,996,1013,943,939,998,1009,1002,996,996,994,1011,1011,1018,988,934,943,941,990,996,1008,1006^1010,950,949,954,954,951,950,953,948,953^995,1008,1008,1012,1013,1002,1007,1000,988,934,943,941,990,1009,1011,1008,943,939,1006,1008,1014,1007,1013^1126,1087,1071,1125,1088,1058,943,939,947,953,949,950,954,951,948,945,948^996,1008,1007,1013,994,996,1013,943,939,998,1009,1002,996,996,994,1011,1011,1018,988,934,943,941,990,1007,998,1013^1016,1013,1012,996,1011,994,1019,1018,996,1001,998,994,1009,999,994,1012,1013,1006,1018,1013,1001,1002,996,946,945,946,950,1016,998,998,1004,1005,1018,943,939,1018,1008,1014,996,994,1007,996,1001,1008,1008,1012,998,994,1007,1018,997,1014,1007,1000,998,1008,1007,943,939,1002,1007,999,1008^997,998,994,1005,1012,943,939,998,1009,1002,996,996,994,1011,1011,1018,934,943,1007,998,1013^1125,1088,1058,1012,998,1012,998,1000,1008,1005,997^1012,998,1011,1015,1002,996,998,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006^997,1002,1012,996,1008,1011,997,997,1008,1011,1013,1016,1002,1017,947,947,950,949^1016,1013,1012,943,939,994,1007,997,1008,1013,1001,998,1011,1015,1002,996,1002,1008,1014,1012,1006,1008,1014,1007,1013,1012,943,939,1015,1002,994,934,997,1015,934,997,943,939,1006,1014,1005,1013,1002,1009,1005,998,1013,998,994,1006,1012,943,939,1012,998,1005,999,1009,1005,994,1018^1012,1004,1018,1009,998,943,939,995,1013,994,1000,943,939,1009,1011,998,1013,1013,1018,998,1005,998,1007,994^1009,1011,1008,997,1014,996,1013,943,939,1006,1006,988,1008,945,990,1005,1015,1005,988,934,943,941,990,996,988,1008,945,990,1006^1016,1013,1012,1015,1002,996,1002,1008,1014,1012,943,939,1005,998,1000,994,996,1018,1009,1015,1009,1006,1008,1014,1007,1013,1012,943,939,994,996,1001,1002,998,1015,943,939,1008,1009,1013,1002,1008,1007,994,1005^999,994,1012,1013,949,1000,1008,1005,997,988,934,943,941,990,996,1008,1006,943,939,1012,1008,1013,996,1004^1126,1037,1083,1002,1008,1019,1008,1125,1086,1039,1125,1088,1054,1128,1050,1086,1129,1040,1053,1125,1084,1080,1126,1038,1026,1130,1025,1026,1125,1081,1025,949,1128,1045,1075,1126,1081,1071,1127,1042,1081,1002,1008,1126,1074,1027,1125,1086,1039,1125,1088,1054,1127,1053,1025^1010,1010,943,939,948,950,953,947,947,945,945,951,951^1008,999,999,998,1011,943,939,998,1009,1002,996,996,994,1011,1011,1018,988,941,934,943,990,996,1008,1006^1002,1007,999,1008,943,939,1016,998,995,1012,1002,1013,998,943,939,1003,1014,1012,1013,995,1008,1008,1012,1013^1002,1008,1016,943,939,1011,1006,995,943,939,1008,1004,949,1000,1008,1005,997^1105,1086,1105,1081,1105,1080,1004,1105,1081,998,1106,1031,998,1105,1086,1106,1036,943,939,1000,998,1013,1005,1008,1008,1013,988,934,943,941,990,1011,1014^1010,1010,943,939,948,949,950,945,948,949,950^1016,1013,1012,1015,1002,996,1002,1008,1014,1012,943,939,996,994,1011,1011,1018,1018,1008,1014,1011,998,1000,994,1011,997,943,939,1012,998,1005,999,1009,1005,994,1018,943,939,1011,998,1005,994,1013,998,997,1012,1013,1014,999,999^1012,1004,1018,1009,998,943,939,1007,1002,1000,1001,1013,999,1002,1011,998,1016,1008,1016,943,939,1000,1008,1008,997^997,1002,1012,996,1008,1011,997,1006,1018,1013,1001,1002,996,950,949,949,953^1012,1004,1018,1009,998,943,939,1003,1014,1012,1013,1002,1007,934,943,1009,1005,994,996,1008,1012^1015,1017,997,994,1002,1016,1008,1016,953,953,953^997,1002,1012,996,1008,1011,997,943,939,997,1015,1002,1007,1000,1012,1014,1009,1009,1008,1011,1013^1010,1128,1087,1061,943,939,946,947,947,953,952,946,951,952,946^1126,1052,1059,943,939,946,947,954,947,952,945,951,946,948,949^1015,1002,1012,1002,1013,943,939,1016,1008,1016,995,1008,1009,934,943,996,1008,1006^991,1006,994,1011,1002,1007,994,1125,1081,1044,1125,1081,1051,1128,1051,1029,1127,1035,1061,1128,1041,1031,1125,1081,1044,1126,1071,1079^1012,1004,1018,1009,998,943,939,1003,994,1007,998,995,1008,1008,1012,1013^1016,994,1005,1005,1000,994,1006,1002,1007,1000,943,939,1005,1008,1008,1013,943,939,1004,998,1018,1012,1013,1008,1007,998^1010,1010,943,939,946,950,948,953,952,949,945,951,954^1015,1002,1012,1002,1013,943,939,998,1009,934,943,960,1002,996,996,994,1011,1011,1018,934,943,996,1008,1006^1006,1018,1013,1001,1002,996,943,939,995,1008,1008,1012,1013,943,939,999,1011,998,998,943,939,1000,998,994,1011,943,939,995,998,1012,1013,1009,1011,1002,996,998,943,939,1002,1007,999,1008^1000,1008,1008,1000,1005,998,943,939,998,1009,1002,996,996,994,1011,1011,1018^1125,1088,1058,953,954,949,950,953,945,947,948,946^996,994,1105,1082,1013,943,939,1004,1002,1007,1000,1000,1008,1005,997,988,934,943,941,990,1011,1014^1105,1088,1009,1008,1105,1077,994,1105,1079,994,943,939,996,1008,1002,1007,1012,1012,1013,1008,1011,998,988,934,943,941,990,1011,1014^1126,1087,1071,1125,1088,1058,943,939,946,953,945,950,954,948,954,952,950,951,945^997,1015,1002,1007,1000,988,934,943,941,990,1011,1014,943,939,1018,996,1105,1084,1018,1011,1105,1081^1010,1010,943,939,946,950,946,948,954,949,946,953,946,949^996,1011,1014,1012,994,997,998,1011,943,939,1127,1072,1046,1125,1081,1051,943,939,1004,1005,1019,943,939,1126,1065,1026,1127,1053,1052,943,939,1127,1066,1050^1126,1030,1065,1128,1087,1039,1130,1063,1047,1127,1054,1025,1126,1030,1069,1125,1085,1051,943,939,1005,1002,1006,1002,1013,943,939,1126,1032,1083,1126,1045,1071,1126,1040,1075,1129,1072,1048,943,939,1126,1040,1061,1126,1073,1045,1125,1081,1082,1126,1054,1041,1130,1067,1042^1126,1087,1071,1125,1088,1058,943,939,946,948,954,952,950,952,948,946,947,951,952^1009,998,1016,1009,998,1016,1012,1001,1008,1009,934,943,1009,1011,1008,943,939,1006,1018,1013,1001,1002,996^1008,1005,1008,1005,1008,1009,998,1016,950,949,949,953^1125,1088,1058,948,954,954,946,947,953,950,949,953^1125,1081,1084,1129,1029,1042,1126,1054,1041,1130,1067,1042,943,939,1130,1028,1086,1125,1088,1054,1126,1083,1046,943,939,1128,1070,1034,1128,1083,1064,943,939,1129,1060,1030,1128,1070,1034,943,939,1125,1081,1047,1125,1084,1084,943,939,1009,1015,1009^934,997,934,997,934,997,1004,1000,1008,1005,997,943,939,1012,1013,994,1011,1013,1007,1008,1016,943,939,996,1014,1011,1015,998,943,939,1005,1008,1008,1013,994,1011,998,1012,1001,994,1011,998,997,943,939,999,1014,1005,1005,1000,1014,1002,1005,997,943,939,997,1002,1012,996,1008,1011,997^1004,1005,1019,943,939,1127,1034,1060,946,949,953,949,949,952,946,947,947,949^1126,1087,1071,1125,1088,1058,943,939,946,950,953,950,952,951,947,950,945,945,951","1131,1068,1043,1126,1082,1052,1127,1036,1059^1130,1027,1038,1126,1082,1052,1127,1055,1042,1131,1068,1043^1010,1012,1009,1000,1000,961,999,1013,1013,961,1003,1009,1008,995,1006^1127,1034,1081,1128,1067,1051^1130,1027,1038,1126,1082,1052,1127,1053,1060,1131,1050,1057^1011,1015,995,1008,1014,1003,1014,1019^1010,1003,1006,989,1009,946,991,1014,999,998^1126,1085,1081^1001,1015,995,1012,995,1008,1014,999,999^1131,1061,1056,1130,1059,1038,1130,1065,1061,1131,1046,1027^997,1009,998,999^996,989,1009,946,991,989,1009,946,991,1013,1014^1006,999,1016,999,1006,1003,1008,1001^1012,996,1001^1011,1015,995,1006,1003,1014,1019^1007,989,1009,946,991,1015,1008,1014^1013,999,995,1013,1009,1008^1006,1003,1016,999,997,1002,995,1014^995,1012,999,1008,995^1131,1050,1089,1127,1041,1062,1128,1048,1073,1128,1034,1042,1127,1074,1075^1130,1035,1084,1128,1035,1037,1126,1085,1061,1128,1035,1045^1013,999,997,1015,1012,999^1013,995,1006,999^997,1009,1015,1010,1009,1008^997,1002,999,995,1010^999,1018,1010,999,1012,1003,999,1008,997,999^1001,1006,995,998,1003,995,1014,1009,1012^1010,995,997,1005,995,1001,999^1015,1008,1006,1009,997,1005^995,997,997,1009,1015,1008,1014^998,1003,1013,997,1009,1015,1008,1014^1130,1078,1086,1128,1077,1047,1127,1088,1081^1000,995,1013,1014^1013,999,1012,1016,1003,997,999^998,999,1006,1003,1016,999,1012,1019^1013,1014,1009,1012,999^1010,995,1019,1010,995,1006^1017,999,996,997,1002,995,1014^995,997,997,1013,1002,995,1012,989,999,1003,991^1010,1012,1003,997,999^1006,999,1001,995,1006^1128,1048,1074,1129,1065,1039,1128,1049,1041,1127,1083,1085,1127,1038,1048,1130,1065,1061,1131,1046,1027^1013,995,1000,999^1129,1085,1029,1129,1084,1065^997,1015,1013,1014,1009,1007,999,1012^1016,1003,1013,1003,1014,944,940,1017,999,996,1013,1003,1014,999^1127,1055,1042,1131,1068,1043^997,1009,995,997,1002,1003,1008,1001^1128,1048,1074,1129,1065,1039,1128,1049,1041,1130,1065,1061,1131,1046,1027^1131,1061,1056,1130,1059,1038,1128,1034,1042,1127,1074,1075^1013,1005,1019,1010,999^1013,1015,1010,1010,1009,1012,1014^1012,995,1014,1003,1008,1001^1130,1065,1061,1131,1046,1027,1131,1061,1056,1130,1059,1038^1014,1012,1015,1013,1014,1010,1003,1006,1009,1014^1006,1003,999,1000,999,1012,1015,1008,1001^997,1009,1007,1010,999,1014,1003,1014,1003,1009,1008^1013,999,1006,1000,1010,1006,995,1019","1131,1079,1065,1128,1042,1082,1130,1086,1079,1129,1037,1063^1129,1055,1040,1128,1037,1060,1128,1052,1067,936,999,936,999,962,1130,1029,1084,1128,1087,1027,1129,1036,1046^1132,1068,1071,1127,1083,1037,1129,1036,1046,1129,1078,1048","1003,1017,1005,1008,1000,1019,1011,1014,1007,946,999,1011,1009^1019,1011,1019,1004,1011,1014,1000,1001,1015,937,946,999,1011,1009^1003,1017,1005,1008,1000^1015,1004,1005,1018,1016,1014,937,946,999,1011,1009^1001,1010,1006,1005,1010,937,946,999,1011,1009^937,946,998,997,1016,1016,1008,1001,937,946,1010,1001,1016,947^1003,1017,1005,1008,1000,1012,1011,1014,1016,997,1008,937,946,999,1011,1009^1011,1010,1008,1021,997,999,999,1001,1012,1016,1005,963,1010,963,1003,963,1003,1011,1008,1000^1015,1011,999,1005,997,1008^1016,1019,1005,1016,999,1004,937,946,1016,1018^1003,1011,1008,1000,1011,1010,1008,1021^1019,1011,1019,1015,1016,1001,997,1000,937,946,999,1011,1009^937,946,1019,1005,1020,937,946,999,1011,1009^1015,1001,1014,1018,1001,1014,1016,1005,1009,1001^1003,1017,1005,1008,1000,1004,1011,1015,1016,1005,1010,1003,946,1011,1014,1003^1014,1001,999,1014,1017,1005,963,1016^1003,1011,1008,1000,1012,1014,1005,999,1001,1015^1001,1010,1016,1014,997,1010,999,1001^1002,1011,1014,1003,1011,1008,1000^999,1011,1014,1012,1008,997,1017,1010,999,1004,937,946,999,1011,1009^1003,997,1009,1005,1010,1003^937,1000,943,1007,1012,1001,1014,1014,1017,1010^997,1012,1012,1008,991,1005,1021,993^1011,1019,1010,951,1000,937,946,1016,1018^1003,997,1009,1001,1014,1008,997,1017,1010,999,1004,937,946,999,1011,1009^1012,1014,1005,999,1001,937,1000,943,1007^1019,1001,1001,998,1008,1021,937,946,999,1011,1009^1003,997,1009,1001,1016,1005,1009,1001^1000,1001,1012,1001,1010,1000^937,1000,943,1007,991,947,992,993,963,1000,1017,1010,1003,1001,1011,1010^1003,1017,1005,1008,1000,1008,997,1017,1010,999,1004,937,946,999,1011,1009^999,1004,1001,997,1012,1001,1014,1016,1004,997,1010,997,1004^1003,1017,1005,1008,1000,1011,1009,997,1016,1005,999,937,946,999,1011,1009^1019,1011,1019,1008,997,1017,1010,999,1004,937,946,999,1011,1009^1009,1001,1009,998,1001,1014,1015^937,1000,943,1007,991,947,992,993,963,1001,997,999,1004^937,1000,943,1007,1012,1001,1014,1000,1017,1010,1003,1001,1011,1010^1003,1014,1001,1001,1010,1015^1017,1015,1016,1014,1001,997,1009,937,946,1016,1018","1003,1012,1021,1016,1017,1012,1015,1002,938,947,1013,1015,1012^1002,1013,1006,1000,1000,998,1015,1015,1022,992,938,947,945,994,1000,1012,1010^1004,1012,1009,1001,953,1013,1019,1002,938,947,1000,1012,1010^998,1005,1004,1012,1009,1001,1016,938,947,1000,1012,1010^1013,1002,1015,1003,1002,1000,1017,1020,998,1022,992,938,947,945,994,1012,1011,1002^999,1012,1012,1016,1017,951,1011,1006,1004,1005,1017,938,947,1000,1012,1010^1010,1010,1012,1009,1019,1009,992,938,947,945,994,1000,992,949,1012,994,1010^1010,1022,1017,1005,1006,1000,1016,1017,1012,1015,1002,992,938,947,945,994,1000,1012,1010^1020,1020,1020,938,947,1004,998,1010,1002,1015,1002,998,1016,1022,938,947,1000,1012,1010^1016,1005,998,1001,1012,1020,999,1012,1012,1016,1017,938,947,1000,1012,1010^1003,999,1010,1017,1002,998,1010,992,938,947,945,994,1000,1012,1010^1020,1012,1020,1019,1002,1011,1001,1012,1015,938,947,1000,1012,1010^1020,1012,1020,1005,1018,1011,1017,938,947,1011,1002,1017^1001,1019,1006,1011,1004,992,938,947,945,994,1011,1002,1017^999,1012,1012,1016,1017,1012,1015,1002,992,938,947,945,994,1011,1002,1017^1013,1002,1020,1013,1002,1020,1016,1005,1012,1013,992,938,947,945,994,1013,1015,1012^1002,1009,1006,1017,1006,1016,1017,1004,998,1010,1006,1011,1004,992,938,947,945,994,1000,1012,1010^999,1012,1012,1016,1017,999,998,1022,938,947,1000,1012,1010^1012,1008,953,1004,1012,1009,1001,992,938,947,945,994,1000,1012,1010^1020,1012,1020,1019,1002,1011,1001,1012,1015,938,947,1012,1015,1004^1002,1013,1006,1000,1000,998,1015,1015,1022,992,938,947,945,994,1011,1002,1017^1009,1012,1012,1017,1000,1009,1012,1018,1001,1001,1012,1017,1000,1012,1010^1020,1012,1020,999,1012,1013,938,947,1000,1012,1010^1005,1012,1016,1017,1004,1012,1009,1001,1016,938,947,1000,1012,1010^1013,1019,1002,1004,998,1010,1002,1015,1016,938,947,1011,1002,1017^1013,1019,1002,1004,998,1010,1002,1015,1016,938,947,1000,1012,1010^1004,998,1010,1002,998,1018,1000,938,947,1000,1012,1010^1003,999,1010,1017,1002,998,1010,938,947,1011,1002,1017^1003,999,1010,1017,1002,998,1010,938,947,1013,1015,1012^1007,1018,1016,1017,999,1012,1012,1016,1017,938,947,1012,1015,1004^1020,1012,1020,1019,1002,1011,1001,1012,1015,938,947,1011,1002,1017^1002,999,998,1022,1004,1012,1009,1001,1016,938,947,1000,1012,1010^1010,1022,1017,1005,1006,1000,1016,1017,1012,1015,1002,992,938,947,945,994,1011,1002,1017^1009,1002,1004,1006,1012,1011,1003,998,1015,1010,938,947,1000,1012,1010^999,998,1011,1008,953,1001,1005,992,938,947,945,994,964,1000,1012,1010^1014,1018,1006,1000,1008,998,1011,1001,1016,1010,1012,1012,1017,1005,938,947,1000,1012,1010^1009,1002,1013,1015,1002,1016,1017,1012,1015,1002,938,947,1011,1002,1017^1000,1012,1011,1014,1018,1002,1016,1017,1000,998,1013,1013,1002,1001,992,938,947,945,994,1000,1012,1010^1009,1002,1013,1015,1002,1016,1017,1012,1015,1002,938,947,1012,1015,1004^1013,1019,1002,1016,1005,1012,1013,938,947,1013,1015,1012^1020,1012,1020,1005,1018,1011,1017,938,947,1000,1012,1010^1006,1015,998,1011,999,1009,1006,1023,1023,998,1015,1001,938,947,1000,1012,1010^999,1012,1012,1016,1017,1005,1006,1019,1002,992,938,947,945,994,1002,1018^1005,1018,1016,1008,1022,999,992,1012,949,994,992,1012,949,994,1016,1017,938,947,1000,992,1012,949,994,1010^1002,1013,1006,1000,1000,998,1015,1015,1022,992,938,947,945,994,1012,1015,1004^1009,1002,1013,1015,1002,1016,1017,1012,1015,1002,938,947,1000,1012,1010^1004,1012,1009,1001,1001,1002,998,1009,992,938,947,945,994,1015,1018^1017,1006,1017,998,1011,1006,1018,1010,999,998,1022,938,947,1000,1012,1010^1016,1005,998,1001,1012,1020,999,1012,1012,1016,1017,938,947,1010,1009","1021,1013,1021,1020,1003,1012,1002,1013,1016,939,948,1012,1003,1018^1021,1013,1021,1020,1003,1012,1002,1013,1016,939,948,1001,1013,1011^1021,1013,1021,1020,1003,1012,1002,1013,1016,939,948,1013,1016,1005")

local repTbl = {
	--Symbol & space removal
	["[%*%-<>%(%)\"!%?=`'_%+#%%%^&;:~{}%[%] ]"]="",
	["¨"]="", ["”"]="", ["“"]="", ["▄"]="", ["▀"]="", ["█"]="", ["▓"]="", ["▲"]="", ["◄"]="", ["►"]="", ["▼"]="", ["♣"]="",
	["░"]="", ["♥"]="", ["♫"]="", ["●"]="", ["■"]="", ["☼"]="", ["¤"]="", ["☺"]="", ["↑"]="", ["«"]="", ["»"]="", ["♦"]="",
	["▌"]="", ["▒"]="", ["□"]="", ["¬"]="", ["√"]="", ["²"]="", ["´"]="", ["☻"]="", ["★"]="", ["☆"]="", ["◙"]="", ["◘"]="",
	["¦"]="", ["|"]="", [";"]="", ["΅"]="", ["™"]="", ["。"]="", ["◆"]="", ["◇"]="", ["♠"]="", ["△"]="", ["¯"]="", [" "]="",
	["《"]="", ["》"]="", ["（"]="", ["）"]="", ["～"]="", ["—"]="", ["！"]="", ["："]="", ["·"]="", ["˙"]="", ["…"]="", ["　"]="",
	["▎"]="", ["▍"]="", ["▂"]="", ["▅"]="", ["▆"]="", ["＋"]="", ["‘"]="", ["’"]="", ["【"]="", ["】"]="", ["│"]="",

	--This is the replacement table. It serves to deobfuscate words by replacing letters with their English "equivalents".
	["а"]="a", ["à"]="a", ["á"]="a", ["ä"]="a", ["â"]="a", ["ã"]="a", ["å"]="a", -- First letter is Russian "\208\176". Convert > \97.
	["Ą"]="a", ["ą"]="a", ["Ā"]="a", ["ā"]="a", ["Ă"]="a", ["ă"]="a", -- Convert > \97. Note: Ą, Ā, Ă fail with strlower, include both.
	["с"]="c", ["ç"]="c", ["Ć"]="c", ["ć"]="c", ["Č"]="c", ["č"]="c", ["Ĉ"]="c", ["ĉ"]="c", ["Ċ"]="c", ["ċ"]="c", --First letter is Russian "\209\129". Convert > \99. Note: Ć, Č, Ĉ, Ċ fail with strlower, include both.
	["Ď"]="d", ["ď"]="d", ["Đ"]="d", ["đ"]="d", --Convert > \100. Note: Ď, Đ fail with strlower, include both.
	["е"]="e", ["è"]="e", ["é"]="e", ["ë"]="e", ["ё"]="e", ["ê"]="e", --First letter is Russian "\208\181". Convert > \101.
	["Ę"]="e", ["ę"]="e", ["Ė"]="e", ["ė"]="e", ["Ě"]="e", ["ě"]="e", ["Ē"]="e", ["ē"]="e", ["Έ"]="e", ["έ"]="e", ["Ĕ"]="e", ["ĕ"]="e", ["Ε"]="e", ["ε"]="e", --Note: Ę, Ė, Ě, Ē, Έ, Ĕ, Ε fail with strlower, include both.
	["Ğ"]="g", ["ğ"]="g", ["Ĝ"]="g", ["ĝ"]="g", ["Ģ"]="g", ["ģ"]="g", ["Ġ"]="g", ["ġ"]="g", -- Convert > \103. Note: Ğ, Ĝ, Ģ, Ġ fail with strlower, include both.
	["Ĥ"]="h", ["ĥ"]="h", -- Convert > \104. Note: Ĥ fail with strlower, include both.
	["ì"]="i", ["í"]="i", ["ï"]="i", ["î"]="i", ["İ"]="i", ["ı"]="i", -- Convert > \105.
	["Ϊ"]="i", ["ϊ"]="i", ["Ι"]="i", ["ι"]="i", ["Ί"]="i", ["ί"]="i", ["Ĭ"]="i", ["ĭ"]="i", ["Ї"]="i", ["ї"]="i", --Convert > \105. -- Note: Ϊ, Ι, Ί, Ĭ, Ї fail with strlower, include both.
	["Į"]="i", ["į"]="i", ["Ĩ"]="i", ["ĩ"]="i", ["Ī"]="i", ["ī"]="i", ["Ｉ"]="i", ["ｉ"]="i", --Convert > \105. -- Note: Į, Ĩ, Ī, Ｉ fail with strlower, include both.
	["Ĵ"]="j", ["ĵ"]="j", -- Convert > \106. -- Note: Ĵ fail with strlower, include both.
	["к"]="k", ["Ķ"]="k", ["ķ"]="k", -- First letter is Russian "\208\186". Convert > \107. -- Note: Ķ fail with strlower, include both.
	["Ł"]="l", ["ł"]="l", ["Ĺ"]="l", ["ĺ"]="l", ["Ľ"]="l", ["ľ"]="l", -- Convert > \107. -- Note: Ł, Ĺ, Ľ fail with strlower, include both.
	["Μ"]="m", ["м"]="m", -- First letter is capital Greek μ "\206\156". Convert > \109
	["η"]="n", ["ή"]="n", ["ñ"]="n", ["Ν"]="n", -- First letter is small Greek eta η "\206\183". Convert > \110.
	["Ń"]="n", ["ń"]="n", ["Ņ"]="n", ["ņ"]="n", ["Ň"]="n", ["ň"]="n", ["Ŋ"]="n", ["ŋ"]="n", --Convert > \110. Note: Ń, Ņ, Ň, Ŋ fail with strlower, include both.
	["о"]="o", ["ò"]="o", ["ó"]="o", ["ö"]="o", ["ô"]="o", ["õ"]="o", ["ø"]="o", ["σ"]="o", --First letter is Russian "\208\190". Convert > \111.
	["Ō"]="o", ["ō"]="o", ["Ǿ"]="o", ["ǿ"]="o", ["Ő"]="o", ["ő"]="o", ["Θ"]="o", ["θ"]="o", ["Ŏ"]="o", ["ŏ"]="o", ["Ｏ"]="o", ["ｏ"]="o", --Note: Ō, Ǿ, Ő, Θ, Ŏ, Ｏ fail with strlower, include both.
	["р"]="p", ["þ"]="p", ["φ"]="p", ["Ρ"]="p", ["ρ"]="p", --First letter is Russian "\209\128". Convert > \112. --Note: Ρ fail with strlower, include both.
	["Ｑ"]="q", ["ｑ"]="q", --Note: Ｑ fail with strlower, include both.
	["г"]="r", ["я"]="r", ["Ř"]="r", ["ř"]="r", ["Ŕ"]="r", ["ŕ"]="r", ["Ŗ"]="r", ["ŗ"]="r", --Convert > \114. -- Note: Ř, Ŕ, Ŗ fail with strlower, include both.
	["Ş"]="s", ["ş"]="s", ["Š"]="s", ["š"]="s", ["Ś"]="s", ["ś"]="s", ["Ŝ"]="s", ["ŝ"]="s", ["Ѕ"]="s", ["ѕ"]="s", --Convert > \115. -- Note: Ş, Š, Ś, Ŝ, Ѕ fail with strlower, include both.
	["т"]="t", ["Ŧ"]="t", ["ŧ"]="t", ["Τ"]="t", ["τ"]="t", ["Ţ"]="t", ["ţ"]="t", ["Ť"]="t", ["ť"]="t", --Convert > \116. -- Note: Ŧ, Τ, Ţ, Ť fail with strlower, include both.
	["ù"]="u", ["ú"]="u", ["ü"]="u", ["û"]="u", --Convert > \117.
	["Ų"]="u", ["ų"]="u", ["Ŭ"]="u", ["ŭ"]="u", ["Ů"]="u", ["ů"]="u", ["Ű"]="u", ["ű"]="u", ["Ū"]="u", ["ū"]="u", --Convert > \117. -- Note: Ų, Ŭ, Ů, Ű, Ū fail with strlower, include both.
	["ω"]="w", ["ώ"]="w", ["Ẃ"]="w", ["ẃ"]="w", ["Ẁ"]="w", ["ẁ"]="w", ["Ŵ"]="w", ["ŵ"]="w", ["Ẅ"]="w", ["ẅ"]="w", ["Ｗ"]="w", ["ｗ"]="w", -- First letter is small Greek omega Ώ "\207\142". Convert > \119. -- Note: Ẃ, Ẁ, Ŵ, Ẅ, Ｗ fail with strlower, include both.
	["у"]="y", ["ý"]="y", ["Ÿ"]="y", ["ÿ"]="y", -- First letter is Russian "\209\131". Convert > \121. -- Note: Ÿ fail with strlower, include both.
	["０"]="0", ["１"]="1", ["２"]="2", ["３"]="3", ["４"]="4", ["５"]="5", ["６"]="6", ["７"]="7", ["８"]="8", ["９"]="9",
	["•"]=".", ["·"]=".", ["，"]=",", ["º"]="o", ["®"]="r", ["○"]="o", ["†"]="t",
}

--[[ Chat Scanning ]]--
local Ambiguate, GetGameAccountInfoByGUID, strfind, gsub, lower, next, type, tremove = Ambiguate, C_BattleNet.GetGameAccountInfoByGUID, string.find, string.gsub, string.lower, next, type, tremove
local IsFriend, IsGuildMember, UnitInRaid, UnitInParty, SetCVar, GetCVarBool = C_FriendList.IsFriend, IsGuildMember, UnitInRaid, UnitInParty, C_CVar.SetCVar, C_CVar.GetCVarBool
local CanReportPlayer, OpenReportPlayerDialog, PlayerLocation = C_ReportSystem.CanReportPlayer, C_ReportSystem.OpenReportPlayerDialog, PlayerLocation
local spamCollector, spamLogger, prevShow, enableBubble = {}, {}, 0, false
local blockedLineId, et, chatLines, chatPlayers = 0, 7, {}, {}
local btn, reportFrame
local function IsFriendly(name, flag, _, guid)
	if not guid then return true end -- LocalDefense automated prints
	if not guid:find("^Player") then -- Bad addons
		local msg = "BadBoy: Unexpected GUID requested by an addon: ".. guid
		print(msg)
		geterrorhandler()(msg)
		return true
	end
	local isBnetFriend = GetGameAccountInfoByGUID(guid)
	if isBnetFriend or IsGuildMember(guid) or IsFriend(guid) or UnitInRaid(name) or UnitInParty(name) or flag == "GM" or flag == "DEV" then
		return true
	end
end
local function Cleanse(msg)
	msg = gsub(msg, "|c[^%[]+%[([^%]]+)%]|h|r", "%1") -- Speed up processing messages with links by removing them
	msg = lower(msg) --Lower all text, remove capitals
	for k,v in next, repTbl do
		msg = gsub(msg, k, v)
	end
	return msg
end
local eventFunc = function(_, event, msg, player, _, _, _, flag, channelId, _, _, _, lineId, guid)
	-- Re-enable chat bubbles if they were disabled in the previous event.
	if enableBubble then
		enableBubble = false
		SetCVar("chatBubbles", 1)
	end

	blockedLineId = 0
	if event == "CHAT_MSG_CHANNEL" and (channelId == 0 or type(channelId) ~= "number") then return end --Only scan official custom channels (gen/trade)

	local trimmedPlayer = Ambiguate(player, "none")
	if IsFriendly(trimmedPlayer, flag, nil, guid) then return end

	local debug = msg --Save original message format
	msg = Cleanse(msg)

	--20 line text buffer, this checks the current line, and blocks it if it's the same as one of the previous 20
	if event == "CHAT_MSG_CHANNEL" then
		local cleanestMsg = gsub(msg, "[@,./\\=]", "") -- Anything purposely not removed by Cleanse()
		for i=1, #chatLines do
			if chatLines[i] == cleanestMsg and chatPlayers[i] == guid then --If message same as one in previous 20 and from the same person...
				blockedLineId = lineId
				-- Reduce the chances of a spam report expiring (line id is too old) by refreshing it
				if spamCollector[guid] and S.is(msg) then
					local loc = PlayerLocation:CreateFromChatLineID(lineId)
					spamCollector[guid] = loc
					if BADBOY_OPTIONS.tipSpam then
						spamLogger[guid] = debug
					end
				end
				--
				return
			end
			if i == 20 then tremove(chatLines, 1) tremove(chatPlayers, 1) end --Don't let the DB grow larger than 20
		end
		chatLines[#chatLines+1] = cleanestMsg
		chatPlayers[#chatPlayers+1] = guid
	end
	--End text buffer

	if S.is(msg) then
		if event == "CHAT_MSG_SAY" or event == "CHAT_MSG_YELL" then
			-- Awful way of disabling chat bubbles when spam is detected.
			-- Chat bubbles are processed internally by the game client AFTER all the addon event handlers are fired.
			if GetCVarBool("chatBubbles") then
				enableBubble = true
				SetCVar("chatBubbles", 0)
			end
		end
		if not BADBOY_OPTIONS.freqButton then
			for i = 1, #S[et] do
				if strfind(msg, S[et][i]) then
					blockedLineId = lineId
					return
				end
			end
		end
		if BadBoyLog then
			BadBoyLog("BadBoy", event, trimmedPlayer, debug)
		end
		if not BADBOY_BLACKLIST[guid] and not IsEncounterInProgress() then
			local loc = PlayerLocation:CreateFromChatLineID(lineId)
			spamCollector[guid] = loc
			if BADBOY_OPTIONS.tipSpam then
				spamLogger[guid] = debug
				if btn:IsShown() and reportFrame:IsMouseOver() then
					reportFrame:GetScript("OnLeave")(reportFrame) -- Add more spam to tooltip if shown
					reportFrame:GetScript("OnEnter")(reportFrame)
				end
			end

			local t = GetTime()
			if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
				prevShow = t
				btn:Show()
			end
		end

		blockedLineId = lineId
		return
	elseif next(spamCollector) then
		local t = GetTime()
		if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
			prevShow = t
			btn:Show()
		end
	end
end
local filterFunc = function(_, _, _, _, _, _, _, _, _, _, _, _, lineId)
	if blockedLineId == lineId then
		return true
	end
end

do
	--temp
	local xpcall = xpcall
	local dummy = function() end
	--end temp
	btn = CreateFrame("Frame", nil, ChatFrame1)
	btn:SetWidth(50)
	btn:SetHeight(50)
	btn:SetPoint("BOTTOMRIGHT", 18, -20)
	btn:SetFrameStrata("DIALOG")
	local tx = btn:CreateTexture()
	tx:SetAllPoints(btn)
	tx:SetMask("Interface\\CharacterFrame\\TempPortraitAlphaMask")
	tx:SetTexture(132360) -- Interface/Icons/Ability_Warrior_ShieldMastery
	local animGroup = btn:CreateAnimationGroup()
	animGroup:SetLooping("REPEAT")
	local scale = animGroup:CreateAnimation("Scale")
	scale:SetOrder(1)
	scale:SetFromScale(0.25,0.25)
	scale:SetToScale(1,1)
	scale:SetDuration(0.4)
	local scale2 = animGroup:CreateAnimation("Scale")
	scale2:SetOrder(2)
	scale2:SetFromScale(1,1)
	scale2:SetToScale(0.25,0.25)
	scale2:SetDuration(0.4)
	scale2:SetEndDelay(8)
	animGroup:Play()
	btn:Hide()

	reportFrame = CreateFrame("Button", nil, btn)
	reportFrame:SetAllPoints(ChatFrame1)
	reportFrame:SetFrameStrata("DIALOG")
	local ticker = nil
	local tickerFunc = function()
		local canReport = false
		for k, v in next, spamCollector do
			local go, pass = xpcall(CanReportPlayer, dummy, v)
			if go and pass then
				canReport = true
			else
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		end
		if not canReport then
			btn:Hide()
		end
	end
	btn:SetScript("OnShow", function()
		if ticker then ticker:Cancel() end
		ticker = C_Timer.NewTicker(5, tickerFunc)
		tickerFunc()
		-- Don't animate if the feature is disabled
		if animGroup:IsPlaying() and BADBOY_OPTIONS.noAnim then
			btn:SetWidth(12)
			btn:SetHeight(12)
			animGroup:Stop()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 0, -5)
		elseif not animGroup:IsPlaying() and not BADBOY_OPTIONS.noAnim then
			btn:SetWidth(46)
			btn:SetHeight(46)
			animGroup:Play()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 18, -20)
		end
	end)
	btn:SetScript("OnHide", function()
		if ticker then
			ticker:Cancel()
			ticker = nil
		end
	end)
	reportFrame:SetScript("OnClick", function(self)
		if IsAltKeyDown() then -- Dismiss
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()
			spamCollector, spamLogger = {}, {}
		else -- Report
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()

			local systemMsg = {GetFramesRegisteredForEvent("REPORT_PLAYER_RESULT")} -- Don't show the "Complaint Registered" message
			local calendarError = {GetFramesRegisteredForEvent("CALENDAR_UPDATE_ERROR")} -- Remove calendar error popup (Blizz bug)
			for i = 1, #systemMsg do
				systemMsg[i]:UnregisterEvent("REPORT_PLAYER_RESULT")
			end
			for i = 1, #calendarError do
				calendarError[i]:UnregisterEvent("CALENDAR_UPDATE_ERROR")
			end

			for k, v in next, spamCollector do
				local go, pass = xpcall(CanReportPlayer, dummy, v)
				if go and pass then
					BADBOY_BLACKLIST[k] = true
					if OpenReportPlayerDialog then
						OpenReportPlayerDialog("spam", "Spammer blocked by BadBoy", v)
						if not BADBOY_OPTIONS.temp82Msg then
							BADBOY_OPTIONS.temp82Msg = true
							print("|cFF33FF99BadBoy:|r This is a temporary message to inform you that as of patch 8.2 I am now forced to show you a popup to report spammers. This is a Blizz decision. I am very sorry :(")
							print("|cFF33FF99BadBoy:|r Clicking 'Report Player' on the popup will prevent this popup showing again for this specific spammer, but there may be multiple depending on how busy your server is.")
						end
					end
				end
				spamCollector[k] = nil
				spamLogger[k] = nil
				if BADBOY_BLACKLIST[k] then
					break -- Only open 1 dialog
				end
			end

			for i = 1, #systemMsg do
				-- Compensate for people taking a while to click accept
				C_Timer.After(5, function() systemMsg[i]:RegisterEvent("REPORT_PLAYER_RESULT") end)
			end
			for i = 1, #calendarError do
				-- There's a delay before the event fires
				C_Timer.After(5, function() calendarError[i]:RegisterEvent("CALENDAR_UPDATE_ERROR") end)
			end
		end
	end)
	local tt = CreateFrame("GameTooltip", "bbtt", UIParent, "GameTooltipTemplate")
	reportFrame:SetScript("OnEnter", function(self)
		tt:SetOwner(self, "ANCHOR_CURSOR")
		tt:AddLine(S.spamBlocked, 1, 1, 1)
		tt:AddLine(S.clickToReport, 1, 1, 1)
		if next(spamLogger) then
			tt:AddLine(" ", 0.5, 0.5, 1)
			for _, v in next, spamLogger do
				tt:AddLine(v, 0.2, 1, 0)
			end
		end
		tt:Show()
	end)
	reportFrame:SetScript("OnLeave", function() tt:Hide() end)
end

--[[ Add Filters ]]--
do
	local f = CreateFrame("Frame")
	f:SetScript("OnEvent", eventFunc)
	local tbl = {
		"CHAT_MSG_CHANNEL",
		"CHAT_MSG_YELL",
		"CHAT_MSG_SAY",
		"CHAT_MSG_WHISPER",
		"CHAT_MSG_EMOTE",
		"CHAT_MSG_DND",
		"CHAT_MSG_AFK",
	}
	for i = 1, #tbl do
		local event = tbl[i]
		local frames = {GetFramesRegisteredForEvent(event)}
		for j = 1, #frames do
			local frame = frames[j]
			frame:UnregisterEvent(event)
		end
		f:RegisterEvent(event)
		ChatFrame_AddMessageEventFilter(event, filterFunc)
		for j = 1, #frames do
			local frame = frames[j]
			frame:RegisterEvent(event)
		end
	end
end

--[[ Blacklist ]]--
do
	local f = CreateFrame("Frame")
	f:RegisterEvent("ADDON_LOADED")
	f:RegisterEvent("PLAYER_LOGIN")
	f:SetScript("OnEvent", function(frame, event, addon)
		if addon == "BadBoy" then
			if type(BADBOY_OPTIONS) ~= "table" then BADBOY_OPTIONS = {} end
			if type(BADBOY_BLACKLIST) ~= "table" then BADBOY_BLACKLIST = {} end
			frame:UnregisterEvent(event)
		elseif event == "PLAYER_LOGIN" then
			-- Blacklist DB setup, needed since Blizz nerfed ReportPlayer so hard the block sometimes only lasts a few minutes.
			local dateTbl = date("*t")
			local day = dateTbl.day
			if BADBOY_BLACKLIST.dayFromCal ~= day then
				BADBOY_BLACKLIST = {dayFromCal = day} -- Can't use ADDON_LOADED as date function isn't always ready on very first login.
			end
			SetCVar("spamFilter", 1)
			frame:UnregisterEvent(event)
			BADBOY_OPTIONS.tmp = nil
			BADBOY_OPTIONS.tmpm = nil
			BADBOY_OPTIONS.tmpl = nil
			BADBOY_OPTIONS.freqButton = nil

			-- Chat bubble restore
			frame:SetScript("OnEvent", function()
				if enableBubble then
					enableBubble = false
					SetCVar("chatBubbles", 1)
				end
			end)
			-- Hopefully we never end up in a situation where we've permanently disabled chat bubbles for the user.
			frame:RegisterEvent("PLAYER_LOGOUT")
			frame:RegisterEvent("CHAT_MSG_MONSTER_SAY")
			frame:RegisterEvent("CHAT_MSG_MONSTER_YELL")
		end
	end)
end

_G.BadBoyIsFriendly = IsFriendly
_G.BadBoyCleanse = Cleanse
